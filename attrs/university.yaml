global:
    seperator: ","
    name: attrs
    source : "/tmp/zdata/ipeds/hd<year>.zip"
    use_schema: True
    encoding: False
    strip_column_whitespace: True
    output : "/tmp/zdata/output/ipeds/hd/<year>"
    force_column_uppercase:
        to_exclude: []
    web_paths:
        "ipeds": "https://nces.ed.gov/ipeds/datacenter/data/hd<year>.zip"
    source_vars:
        year:
            start: 2005
            end: 2013

    concat: YES

    import_to_db: True
    db_settings:
        user: postgres
        password_env_var: DATAUSA_PW
        host: 162.209.124.219
        db_name: datausa

    type:
        FIPS: "str"
        fips: "str"
        COUNTYCD: "str"
        CBSA: "str"
        UNITID: "str"
        countycd: "str"

    rename:
        UNITID: id
        INSTNM: name
        FIPS: state
        COUNTYCD: county
        CBSA: msa
        WEBADDR: url
        INSTCAT: category
        SECTOR: sector
        # F1SYSCOD: parent_code
        LONGITUD: lng
        LATITUDE: lat

    transform:
        state:
            -
                type: "concat_and_fill"
                prefix: "04000US"
                zfill: 2

        county:
            -
                type: "ifmissing"
                default: "XXXXX"

            -
                type: "concat_and_fill"
                prefix: "05000US"
                zfill: 5
        msa:
            -
                type: "ifmissing"
                default: "XXXXX"
            -
                type: "concat_and_fill"
                prefix: "31000US"
                zfill: 5
        id:
            -
                type: "cast"
                as: str
        lat:
            type: ifmissing
            default: None
        lng:
            type: ifmissing
            default: None

    agg:
        url: "any"
        lat: "any"
        lng: "any"

tables:
    ztest_university2:
        pk: ["year", "id", "name", "state", "county", "msa", "category", "sector"] #, "parent_code"]