inherits: ["db.yaml"]

global:
  seperator: ","
  name: acs_<estimate>yr
  use_schema: True
  source: "data/acs_<estimate>yr/<year>_<estimate>_<state>_<sumlevel>_<tbl>_<column>.json"
  filetype: json

  source_vars:
    year: [2016]
    estimate: [1, 5]
    state: ["01","02","04","05","06","08","09","10","11","12","13","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","44","45","46","47","48","49","50","51","53","54","55","56","72"]
    sumlevel:
      - "public+use+microdata+area"

  source_vars_nesting:
    year:
      estimate:
        state:
          sumlevel:
            - tbl
            - column


  preprocess:
    func: "src.plugins.preprocess.acs_preprocess"

  output: "data/output/acs_<estimate>yr/<state>_<year>_<sumlevel>_<tbl>_<column>"

  web_paths: "http://api.census.gov/data/<year>/acs/acs<estimate>?get=<tbl>_<column>E,<tbl>_<column>M&for=<sumlevel>&in=state:<state>&key=$ACS_KEY"
  concat: YES
  concat_border: estimate

  add_pks: True

  transform:
    - type: plugin
      func: src.plugins.census.acs.helper.clean_geoids
    - type: drop
      strict: NO
      column:
        - tbl
        - sumlevel
        - column
        - estimate
        - "us"
        - "state"
        - "county"
        - "metropolitan statistical area/micropolitan statistical area"
        - "place"
        - "zip code tabulation area"
        - "public use microdata area"
        - "tract"
        - "race"

  rename:
    GEOID: geo
