inherits: ["db.yaml"]

global:
    source: "data/bls/growth/naics/industry.xlsx"
    web_paths: http://www.bls.gov/emp/industry-employment/industry.xlsx
    name: bls
    use_schema: True
    na_values: [".", "-"]
    skiprows: 3
    output : "data/output/bls/growth/naics"
    filetype: excel
    sheetname: "Table 2.7"
    db_settings:
      type:
        output_2006: real
        output_2016: real
        output_2026: real
        output_carc_2006_2016: real
        output_carc_2016_2026: real
    rename:
        "Unnamed: 0": "title"
        "Unnamed: 1": "naics"
        2006: emp_2006_thousands
        2016: emp_2016_thousands
        2026: emp_2026_thousands
        "2006.1": "output_2006"
        "2016.1": "output_2016"
        "2026.1": "output_2026"
        "2006-16": "emp_change_2006_2016"
        "2016-26": "emp_change_2016_2026"
        "2006-16.1": "emp_carc_2006_2016"
        "2016-26.1": "emp_carc_2016_2026"
        "2006-16.2": "output_carc_2006_2016"
        "2016-26.2": "output_carc_2016_2026"

    transform:
        -
            column: naics
            type: replace
            target: " "
            value: ""
        - column: naics
          type: set_val
          value: "000000"
          where:
            column: title
            func: "eq"
            value: "Total(1)(2) "

    post_agg_transform:
        - type: filter
          column: naics
          func: ne
          value: '!UNKNOWN!'
        - type: filter
          column: title
          func: ne
          value: 'Nonagriculture self-employed(4) '

tables:
    growth_i_2016:
        pk: ["naics", "title"]
