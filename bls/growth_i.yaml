global:
    source: "data/bls/growth/naics/occupation.xls"
    web_paths: http://www.bls.gov/emp/industry-employment/industry.xls
    name: bls
    use_schema: True
    na_values: [".",]
    skiprows: 3
    output : "data/output/bls/growth/naics"
    filetype: excel
    sheetname: "Table 2.7"
    rename:
        "Unnamed: 0": "title"
        "Unnamed: 1": "naics"
        2002: emp_2002_thousands
        2012: emp_2012_thousands
        2022: emp_2022_thousands
        "2002.1": "output_2002"
        "2012.1": "output_2012"
        "2022.1": "output_2022"
        "2002 - 2012": "emp_change_2002_2012"
        "2012 - 2022": "emp_pct_change_2012_2022"
        "2002 - 2012.1": "emp_carc_2002_2012"
        "2012 - 2022.1": "emp_carc_2012_2022"
        "2002 - 2012.2": "output_carc_2002_2012"
        "2012 - 2022.2": "output_carc_2012_2022"
    transform:
        -
            column: naics
            type: replace
            target: " "
            value: ""

    agg: "sum"
    import_to_db: True
    db_settings:
        user: postgres
        password_env_var: DATAUSA_PW
        host: 162.209.124.219
        db_name: datausa

    filter:
        -
            column: "naics"
            func: "eq"
            value: "!UNKNOWN!"

tables:
    growth_i:
        pk: ["naics"]
