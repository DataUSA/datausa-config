global:
    seperator: ","
    name: ipeds
    source : "data/ipeds/c<year>_a.zip"
    use_schema: True
    encoding: utf-8-sig

    strip_column_whitespace: True

    source_vars:
        year:
            start: 2008
            end: 2011

    output : "data/output/ipeds/<year>"

    web_paths:
        "ipeds": "https://nces.ed.gov/ipeds/datacenter/data/c<year>_a.zip"

    na_values: ['']

    fillna:
        mode: True
        value: 0

    transform:
        course_id:
            -
                type: replace
                target: "."
                value: ""
            -
                type: strip

    import_to_db: True
    db_settings:
        user: postgres
        password_env_var: DATAUSA_PW
        host: 162.209.124.219
        db_name: datausa

    post_agg_add_pklengths: 1
    deduplicate: True
    rename:
        UNITID: university_id
        CIPCODE: course_id
        AWLEVEL: degree_id
        CTOTALT: total
        CTOTALM: total_men
        CTOTALW: total_women
        CAIANT: total_native
        CAIANM: total_native_men
        CAIANW: total_native_women
        CASIAT: total_asian
        CASIAM: total_asian_men
        CASIAW: total_asian_women
        CBKAAT: total_black
        CBKAAM: total_black_men
        CBKAAW: total_black_women
        CHISPT: total_hispanic
        CHISPM: total_hispanic_men
        CHISPW: total_hispanic_women
        CNHPIT: total_hawaiian
        CNHPIM: total_hawaiian_men
        CNHPIW: total_hawaiian_women
        CWHITT: total_white
        CWHITM: total_white_men
        CWHITW: total_white_women
        C2MORT: total_multi
        C2MORM: total_multi_men
        C2MORW: total_multi_women
        CUNKNT: total_unknown
        CUNKNM: total_unknown_men
        CUNKNW: total_unknown_women
        CNRALT: total_nonresident 
        CNRALM: total_nonresident_men
        CNRALW: total_nonresident_women

tables:
    grads_yucd:
        pk: ["year", "university_id", "course_id", "degree_id"]
        depths: { "year": ["identity"], "university_id" : [YES], "course_id": [2, YES], "degree_id": ["identity"]  }

        agg:
            total: "sum"
            total_men: "sum"
            total_women: "sum"
            total_native: "sum"
            total_native_men: "sum"
            total_native_women: "sum"
            total_asian: "sum"
            total_asian_men: "sum"
            total_asian_women: "sum"
            total_black: "sum"
            total_black_men: "sum"
            total_black_women: "sum"
            total_hispanic: "sum"
            total_hispanic_men: "sum"
            total_hispanic_women: "sum"
            total_hawaiian: "sum"
            total_hawaiian_men: "sum"
            total_hawaiian_women: "sum"
            total_white: "sum"
            total_white_men: "sum"
            total_white_women: "sum"
            total_multi: "sum"
            total_multi_men: "sum"
            total_multi_women: "sum"
            total_unknown: "sum"
            total_unknown_men: "sum"
            total_unknown_women: "sum"
            total_nonresident: "sum"
            total_nonresident_men: "sum"
            total_nonresident_women: "sum"
