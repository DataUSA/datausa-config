global:
    seperator: ","
    name: acs
    use_schema: True
    source : "data/acs/<sumlevel>_<tbl>_<column>.json"
    filetype: json
    source_vars:
        sumlevel: ["state", "county"]
        tbl: ["B16001"]
        column:
          start: 1
          end: 119
          zfill: 3

    preprocess:
      func: "src.plugins.preprocess.acs_preprocess"

    output : "data/output/acs/<sumlevel>_<tbl>_<column>"

    web_paths: "http://api.census.gov/data/2013/acs5?get=GEOID,<tbl>_<column>E,<tbl>_<column>M&for=<sumlevel>&key=$ACS_KEY"
    concat: YES

    import_to_db: True
    db_settings:
        user: postgres
        password_env_var: DATAUSA_PW
        host: 162.209.124.219
        db_name: datausa

    regex_drop:
        "B16001_0(04|05|07|08|10|11|13|14|16|17|19)<e_m>": "delete"
        "B16001_0(20|22|23|25|26|28|29|31|32|34|35|37|38|40|41|43|44|46|47|49)<e_m>": "delete"
        "B16001_0(50|52|53|55|56|58|59|61|62|64|65|67|68|70|71|73|74|76|77|79)<e_m>": "delete"
        "B16001_(080|082|083|085|086|088|089|091|092|094|095|097|098|100|101|103|104|106|107|109)<e_m>": "delete"
        "B16001_(110|112|113|115|116|118|119)<e_m>": "delete"

    transform:
      - type: drop
        strict: NO
        column: [tbl, sumlevel, column, state, county]

    rename:
      GEOID: geo_id

tables:
  "yg_lang":
    pk: ["geo_id"]
    agg: sum
