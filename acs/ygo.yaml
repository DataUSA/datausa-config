inherits: "acs/acs_template.yaml"
global:
  concat: NO
  source_vars:
    tbl: ["C24010"]
    column:
      start: 1
      end: 3
      zfill: 3
    sumlevel: ["state"]

  transform:
    - type: set_val
      column: tmp
      value: "_"
    - type: zfill
      size: 3
      column: column
    - type: concat
      column: census_id
      column0: tbl
      column1: tmp
      column2: column
    - type: rename
      column: "C24010_<column>E"
      value: "num_emp"
    - type: rename
      column: "C24010_<column>M"
      value: "num_emp_moe"
    - type: join
      source: acs/occupation_crosswalk.csv
      left_on: census_id
      right_on: census_id

tables:
  "ygo":
    pk: ["year", "geo", "soc"]
    agg:
      num_emp: "sum"
      num_emp_moe: "sum"

